2025-02-06 20:45:36.608 [restartedMain] INFO  r.k.s.b.d.SpringBootSecurityDemoApplication - Starting SpringBootSecurityDemoApplication using Java 22.0.1 with PID 9320 (C:\Users\dimag\IdeaProjects\PP_3_1_2\PP_3_1_2_Boot_Security\target\classes started by dimag in C:\Users\dimag\IdeaProjects\PP_3_1_2\PP_3_1_2_Boot_Security)
2025-02-06 20:45:36.610 [restartedMain] DEBUG r.k.s.b.d.SpringBootSecurityDemoApplication - Running with Spring Boot v3.4.2, Spring v6.2.2
2025-02-06 20:45:36.612 [restartedMain] INFO  r.k.s.b.d.SpringBootSecurityDemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-02-06 20:45:36.721 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-02-06 20:45:36.722 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-02-06 20:45:38.752 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-02-06 20:45:38.872 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 104 ms. Found 2 JPA repository interfaces.
2025-02-06 20:45:40.085 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-02-06 20:45:40.122 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-02-06 20:45:40.122 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-02-06 20:45:40.220 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-02-06 20:45:40.221 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3497 ms
2025-02-06 20:45:40.626 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-02-06 20:45:40.726 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.5.Final
2025-02-06 20:45:40.788 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-02-06 20:45:41.297 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-02-06 20:45:41.343 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-02-06 20:45:41.582 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3d6858be
2025-02-06 20:45:41.585 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-02-06 20:45:41.707 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 9.1
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-02-06 20:45:43.097 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-02-06 20:45:43.225 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-02-06 20:45:43.727 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-02-06 20:45:45.187 [restartedMain] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsImpl
2025-02-06 20:45:45.390 [restartedMain] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page template: index
2025-02-06 20:45:45.554 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 12 mappings in 'requestMappingHandlerMapping'
2025-02-06 20:45:45.573 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/, /login, /access-denied, /error] in 'viewControllerHandlerMapping'
2025-02-06 20:45:45.859 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-02-06 20:45:45.959 [restartedMain] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-02-06 20:45:46.073 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-02-06 20:45:46.221 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-02-06 20:45:46.494 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-02-06 20:45:46.574 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-02-06 20:45:46.592 [restartedMain] INFO  r.k.s.b.d.SpringBootSecurityDemoApplication - Started SpringBootSecurityDemoApplication in 11.628 seconds (process running for 13.142)
2025-02-06 20:45:46.751 [restartedMain] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.username 
    from
        users u1_0
2025-02-06 20:45:46.833 [restartedMain] INFO  r.k.s.b.d.services.UserServiceImpl - All users have been deleted.
2025-02-06 20:45:46.869 [restartedMain] DEBUG org.hibernate.SQL - 
    /* one-shot delete for ru.kata.spring.boot_security.demo.models.User.roles */delete 
    from
        users_roles 
    where
        user_id=?
2025-02-06 20:45:46.881 [restartedMain] DEBUG org.hibernate.SQL - 
    /* one-shot delete for ru.kata.spring.boot_security.demo.models.User.roles */delete 
    from
        users_roles 
    where
        user_id=?
2025-02-06 20:45:46.889 [restartedMain] DEBUG org.hibernate.SQL - 
    /* delete for ru.kata.spring.boot_security.demo.models.User */delete 
    from
        users 
    where
        id=?
2025-02-06 20:45:46.895 [restartedMain] DEBUG org.hibernate.SQL - 
    /* delete for ru.kata.spring.boot_security.demo.models.User */delete 
    from
        users 
    where
        id=?
2025-02-06 20:45:46.905 [restartedMain] INFO  r.k.s.b.d.services.RoleServiceImpl - Deleting all roles
2025-02-06 20:45:46.908 [restartedMain] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:45:46.911 [restartedMain] DEBUG org.hibernate.SQL - 
    /* delete for ru.kata.spring.boot_security.demo.models.Role */delete 
    from
        roles 
    where
        id=?
2025-02-06 20:45:46.912 [restartedMain] DEBUG org.hibernate.SQL - 
    /* delete for ru.kata.spring.boot_security.demo.models.Role */delete 
    from
        roles 
    where
        id=?
2025-02-06 20:45:46.933 [restartedMain] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:45:46.939 [restartedMain] INFO  r.k.s.b.d.services.RoleServiceImpl - Saving role: ROLE_ADMIN
2025-02-06 20:45:46.950 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.Role */insert 
    into
        roles (name) 
    values
        (?)
2025-02-06 20:45:46.973 [restartedMain] INFO  r.k.s.b.d.services.RoleServiceImpl - Saving role: ROLE_USER
2025-02-06 20:45:46.974 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.Role */insert 
    into
        roles (name) 
    values
        (?)
2025-02-06 20:45:46.981 [restartedMain] INFO  r.k.s.b.demo.configs.DataInitializer - Roles have been created successfully.
2025-02-06 20:45:47.424 [restartedMain] DEBUG r.k.s.b.demo.configs.DataInitializer - Encoded Admin Password: $2a$10$vzgK08rRz4oyzYhEWZ..uup.LCofL2ub1Ag2mI1ICBRRR.lsJEUFC
2025-02-06 20:45:47.424 [restartedMain] DEBUG r.k.s.b.demo.configs.DataInitializer - Encoded User Password: $2a$10$EGHyxVj70xd/Co9nz5sXL.jctkHlu5SBwuwfeOyx3JpMmcgvVQl/i
2025-02-06 20:45:47.474 [restartedMain] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id
2025-02-06 20:45:47.486 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User */insert 
    into
        users (age, email, first_name, last_name, password, username) 
    values
        (?, ?, ?, ?, ?, ?)
2025-02-06 20:45:47.491 [restartedMain] INFO  r.k.s.b.d.services.UserServiceImpl - User saved: admin
2025-02-06 20:45:47.505 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User.roles */insert 
    into
        users_roles (user_id, role_id) 
    values
        (?, ?)
2025-02-06 20:45:47.519 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User */insert 
    into
        users (age, email, first_name, last_name, password, username) 
    values
        (?, ?, ?, ?, ?, ?)
2025-02-06 20:45:47.523 [restartedMain] INFO  r.k.s.b.d.services.UserServiceImpl - User saved: user
2025-02-06 20:45:47.524 [restartedMain] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User.roles */insert 
    into
        users_roles (user_id, role_id) 
    values
        (?, ?)
2025-02-06 20:45:47.531 [restartedMain] INFO  r.k.s.b.demo.configs.DataInitializer - Admin and User have been created successfully!
2025-02-06 20:45:47.659 [http-nio-8081-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-02-06 20:45:47.660 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-02-06 20:45:47.661 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-02-06 20:45:47.661 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-02-06 20:45:47.662 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-02-06 20:45:47.665 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@b9af9de
2025-02-06 20:45:47.666 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5c1aec28
2025-02-06 20:45:47.667 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-02-06 20:45:47.667 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 7 ms
2025-02-06 20:45:47.705 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing GET /
2025-02-06 20:45:47.725 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured GET /
2025-02-06 20:45:47.730 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/", parameters={}
2025-02-06 20:45:47.738 [http-nio-8081-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ParameterizableViewController [view="index"]
2025-02-06 20:45:47.767 [http-nio-8081-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:45:48.191 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:45:48.192 [http-nio-8081-exec-1] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@22c378de, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:45:52.227 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing GET /login
2025-02-06 20:45:52.228 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured GET /login
2025-02-06 20:45:52.229 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/login", parameters={}
2025-02-06 20:45:52.230 [http-nio-8081-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ParameterizableViewController [view="login"]
2025-02-06 20:45:52.232 [http-nio-8081-exec-2] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:45:52.618 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:45:52.619 [http-nio-8081-exec-2] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@22c378de, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:45:53.999 [http-nio-8081-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing POST /login
2025-02-06 20:45:54.763 [http-nio-8081-exec-3] DEBUG org.hibernate.SQL - 
    /* SELECT
        u 
    FROM
        User u 
    JOIN
        
    FETCH
        u.roles 
    WHERE
        u.username = :username */ select
            u1_0.id,
            u1_0.age,
            u1_0.email,
            u1_0.first_name,
            u1_0.last_name,
            u1_0.password,
            r1_0.user_id,
            r1_1.id,
            r1_1.name,
            u1_0.username 
        from
            users u1_0 
        join
            users_roles r1_0 
                on u1_0.id=r1_0.user_id 
        join
            roles r1_1 
                on r1_1.id=r1_0.role_id 
        where
            u1_0.username=?
2025-02-06 20:45:55.111 [http-nio-8081-exec-3] DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-02-06 20:45:55.147 [http-nio-8081-exec-3] DEBUG o.s.s.w.a.s.ChangeSessionIdAuthenticationStrategy - Changed session id from 59E51B8E50C66D57B0E8CDA7F25F755E
2025-02-06 20:45:55.152 [http-nio-8081-exec-3] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@66c03010, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=59E51B8E50C66D57B0E8CDA7F25F755E], Granted Authorities=[ROLE_USER]]] to HttpSession [org.apache.catalina.session.StandardSessionFacade@796450ae]
2025-02-06 20:45:55.152 [http-nio-8081-exec-3] DEBUG o.s.s.w.a.UsernamePasswordAuthenticationFilter - Set SecurityContextHolder to UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@66c03010, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=59E51B8E50C66D57B0E8CDA7F25F755E], Granted Authorities=[ROLE_USER]]
2025-02-06 20:45:55.153 [http-nio-8081-exec-3] INFO  r.k.s.b.d.configs.SuccessUserHandler - User 'user' successfully authenticated with roles: [ROLE_USER]
2025-02-06 20:45:55.169 [http-nio-8081-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing GET /user
2025-02-06 20:45:55.170 [http-nio-8081-exec-4] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@66c03010, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=59E51B8E50C66D57B0E8CDA7F25F755E], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:45:55.170 [http-nio-8081-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured GET /user
2025-02-06 20:45:55.170 [http-nio-8081-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/user", parameters={}
2025-02-06 20:45:55.171 [http-nio-8081-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.UserController#userPage(CustomUserDetails, Model)
2025-02-06 20:45:55.207 [http-nio-8081-exec-4] INFO  r.k.s.b.d.controllers.UserController - Authenticated user: user
2025-02-06 20:45:55.244 [http-nio-8081-exec-4] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:45:55.535 [http-nio-8081-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:45:56.263 [http-nio-8081-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing GET /logout
2025-02-06 20:45:56.264 [http-nio-8081-exec-5] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@66c03010, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=59E51B8E50C66D57B0E8CDA7F25F755E], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:45:56.264 [http-nio-8081-exec-5] DEBUG o.s.s.w.a.logout.LogoutFilter - Logging out [UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@66c03010, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=59E51B8E50C66D57B0E8CDA7F25F755E], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:45:56.267 [http-nio-8081-exec-5] DEBUG o.s.s.w.a.l.SecurityContextLogoutHandler - Invalidated session 25A2E9099DD813176BCC4319A38F5521
2025-02-06 20:45:56.268 [http-nio-8081-exec-5] DEBUG o.s.s.web.DefaultRedirectStrategy - Redirecting to /login?logout=true
2025-02-06 20:45:56.280 [http-nio-8081-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing GET /login?logout=true
2025-02-06 20:45:56.303 [http-nio-8081-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured GET /login?logout=true
2025-02-06 20:45:56.304 [http-nio-8081-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/login?logout=true", parameters={masked}
2025-02-06 20:45:56.305 [http-nio-8081-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ParameterizableViewController [view="login"]
2025-02-06 20:45:56.307 [http-nio-8081-exec-6] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:45:56.314 [http-nio-8081-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:45:56.315 [http-nio-8081-exec-6] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-02-06 20:46:01.859 [http-nio-8081-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing POST /login
2025-02-06 20:46:01.861 [http-nio-8081-exec-7] DEBUG org.hibernate.SQL - 
    /* SELECT
        u 
    FROM
        User u 
    JOIN
        
    FETCH
        u.roles 
    WHERE
        u.username = :username */ select
            u1_0.id,
            u1_0.age,
            u1_0.email,
            u1_0.first_name,
            u1_0.last_name,
            u1_0.password,
            r1_0.user_id,
            r1_1.id,
            r1_1.name,
            u1_0.username 
        from
            users u1_0 
        join
            users_roles r1_0 
                on u1_0.id=r1_0.user_id 
        join
            roles r1_1 
                on r1_1.id=r1_0.role_id 
        where
            u1_0.username=?
2025-02-06 20:46:02.035 [http-nio-8081-exec-7] DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-02-06 20:46:02.036 [http-nio-8081-exec-7] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]] to HttpSession [org.apache.catalina.session.StandardSessionFacade@1760b6cb]
2025-02-06 20:46:02.036 [http-nio-8081-exec-7] DEBUG o.s.s.w.a.UsernamePasswordAuthenticationFilter - Set SecurityContextHolder to UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]
2025-02-06 20:46:02.036 [http-nio-8081-exec-7] INFO  r.k.s.b.d.configs.SuccessUserHandler - User 'admin' successfully authenticated with roles: [ROLE_ADMIN]
2025-02-06 20:46:02.044 [http-nio-8081-exec-8] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin
2025-02-06 20:46:02.045 [http-nio-8081-exec-8] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:02.045 [http-nio-8081-exec-8] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin
2025-02-06 20:46:02.045 [http-nio-8081-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin", parameters={}
2025-02-06 20:46:02.045 [http-nio-8081-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#adminPage(CustomUserDetails, Model)
2025-02-06 20:46:02.051 [http-nio-8081-exec-8] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id
2025-02-06 20:46:02.060 [http-nio-8081-exec-8] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:02.069 [http-nio-8081-exec-8] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:02.115 [http-nio-8081-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:03.947 [http-nio-8081-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin/delete/71
2025-02-06 20:46:03.947 [http-nio-8081-exec-9] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:03.948 [http-nio-8081-exec-9] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin/delete/71
2025-02-06 20:46:03.948 [http-nio-8081-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin/delete/71", parameters={}
2025-02-06 20:46:03.948 [http-nio-8081-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#deleteUser(Long)
2025-02-06 20:46:03.967 [http-nio-8081-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        u1_0.id=?
2025-02-06 20:46:03.972 [http-nio-8081-exec-9] INFO  r.k.s.b.d.services.UserServiceImpl - User deleted with ID: 71
2025-02-06 20:46:03.972 [http-nio-8081-exec-9] DEBUG org.hibernate.SQL - 
    /* one-shot delete for ru.kata.spring.boot_security.demo.models.User.roles */delete 
    from
        users_roles 
    where
        user_id=?
2025-02-06 20:46:03.974 [http-nio-8081-exec-9] DEBUG org.hibernate.SQL - 
    /* delete for ru.kata.spring.boot_security.demo.models.User */delete 
    from
        users 
    where
        id=?
2025-02-06 20:46:03.979 [http-nio-8081-exec-9] INFO  r.k.s.b.d.c.AdminController - User deleted successfully with ID: 71
2025-02-06 20:46:03.984 [http-nio-8081-exec-9] DEBUG o.s.web.servlet.view.RedirectView - View name [redirect:], model {}
2025-02-06 20:46:03.985 [http-nio-8081-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 302 FOUND
2025-02-06 20:46:03.992 [http-nio-8081-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin
2025-02-06 20:46:03.992 [http-nio-8081-exec-10] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:03.992 [http-nio-8081-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin
2025-02-06 20:46:03.992 [http-nio-8081-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin", parameters={}
2025-02-06 20:46:03.992 [http-nio-8081-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#adminPage(CustomUserDetails, Model)
2025-02-06 20:46:03.997 [http-nio-8081-exec-10] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id
2025-02-06 20:46:04.004 [http-nio-8081-exec-10] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:04.010 [http-nio-8081-exec-10] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:04.021 [http-nio-8081-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:04.991 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin/create
2025-02-06 20:46:04.992 [http-nio-8081-exec-1] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:04.992 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin/create
2025-02-06 20:46:04.992 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin/create", parameters={}
2025-02-06 20:46:04.993 [http-nio-8081-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#showCreateUserForm(Model)
2025-02-06 20:46:04.997 [http-nio-8081-exec-1] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:05.005 [http-nio-8081-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:05.022 [http-nio-8081-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:21.157 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /admin/add
2025-02-06 20:46:21.158 [http-nio-8081-exec-2] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:21.158 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /admin/add
2025-02-06 20:46:21.158 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/admin/add", parameters={masked}
2025-02-06 20:46:21.159 [http-nio-8081-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#addUser(User, List)
2025-02-06 20:46:21.259 [http-nio-8081-exec-2] DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-02-06 20:46:21.279 [http-nio-8081-exec-2] INFO  r.k.s.b.d.services.RoleServiceImpl - Attempting to find role with ID 66
2025-02-06 20:46:21.280 [http-nio-8081-exec-2] DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-02-06 20:46:21.538 [http-nio-8081-exec-2] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User */insert 
    into
        users (age, email, first_name, last_name, password, username) 
    values
        (?, ?, ?, ?, ?, ?)
2025-02-06 20:46:21.540 [http-nio-8081-exec-2] INFO  r.k.s.b.d.services.UserServiceImpl - User saved: user
2025-02-06 20:46:21.542 [http-nio-8081-exec-2] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User.roles */insert 
    into
        users_roles (user_id, role_id) 
    values
        (?, ?)
2025-02-06 20:46:21.552 [http-nio-8081-exec-2] INFO  r.k.s.b.d.c.AdminController - User added successfully: user
2025-02-06 20:46:21.554 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.view.RedirectView - View name [redirect:], model {}
2025-02-06 20:46:21.554 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 302 FOUND
2025-02-06 20:46:21.561 [http-nio-8081-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin
2025-02-06 20:46:21.562 [http-nio-8081-exec-3] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:21.562 [http-nio-8081-exec-3] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin
2025-02-06 20:46:21.562 [http-nio-8081-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin", parameters={}
2025-02-06 20:46:21.563 [http-nio-8081-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#adminPage(CustomUserDetails, Model)
2025-02-06 20:46:21.568 [http-nio-8081-exec-3] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id
2025-02-06 20:46:21.578 [http-nio-8081-exec-3] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:21.584 [http-nio-8081-exec-3] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:21.604 [http-nio-8081-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:23.352 [http-nio-8081-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin/edit-user/72
2025-02-06 20:46:23.353 [http-nio-8081-exec-4] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:23.354 [http-nio-8081-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin/edit-user/72
2025-02-06 20:46:23.354 [http-nio-8081-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin/edit-user/72", parameters={}
2025-02-06 20:46:23.355 [http-nio-8081-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#showEditUserPage(Long, Model)
2025-02-06 20:46:23.366 [http-nio-8081-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        u1_0.id=?
2025-02-06 20:46:23.376 [http-nio-8081-exec-4] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:23.384 [http-nio-8081-exec-4] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:23.422 [http-nio-8081-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:27.382 [http-nio-8081-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /admin/edit-user
2025-02-06 20:46:27.382 [http-nio-8081-exec-5] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:27.382 [http-nio-8081-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /admin/edit-user
2025-02-06 20:46:27.382 [http-nio-8081-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/admin/edit-user", parameters={masked}
2025-02-06 20:46:27.382 [http-nio-8081-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#editUser(User, List, Model)
2025-02-06 20:46:27.386 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-02-06 20:46:27.392 [http-nio-8081-exec-5] INFO  r.k.s.b.d.services.RoleServiceImpl - Attempting to find role with ID 66
2025-02-06 20:46:27.393 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-02-06 20:46:27.401 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        u1_0.id=?
2025-02-06 20:46:27.510 [http-nio-8081-exec-5] INFO  r.k.s.b.d.services.UserServiceImpl - User updated: user
2025-02-06 20:46:27.515 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    /* update
        for ru.kata.spring.boot_security.demo.models.User */update users 
    set
        age=?,
        email=?,
        first_name=?,
        last_name=?,
        password=?,
        username=? 
    where
        id=?
2025-02-06 20:46:27.517 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    /* one-shot delete for ru.kata.spring.boot_security.demo.models.User.roles */delete 
    from
        users_roles 
    where
        user_id=?
2025-02-06 20:46:27.519 [http-nio-8081-exec-5] DEBUG org.hibernate.SQL - 
    /* insert for
        ru.kata.spring.boot_security.demo.models.User.roles */insert 
    into
        users_roles (user_id, role_id) 
    values
        (?, ?)
2025-02-06 20:46:27.528 [http-nio-8081-exec-5] DEBUG o.s.web.servlet.view.RedirectView - View name [redirect:], model {}
2025-02-06 20:46:27.528 [http-nio-8081-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 302 FOUND
2025-02-06 20:46:27.534 [http-nio-8081-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing GET /admin
2025-02-06 20:46:27.534 [http-nio-8081-exec-6] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:27.534 [http-nio-8081-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured GET /admin
2025-02-06 20:46:27.534 [http-nio-8081-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/admin", parameters={}
2025-02-06 20:46:27.534 [http-nio-8081-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.AdminController#adminPage(CustomUserDetails, Model)
2025-02-06 20:46:27.537 [http-nio-8081-exec-6] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        u1_0.id,
        u1_0.age,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_1.id,
        r1_1.name,
        u1_0.username 
    from
        users u1_0 
    left join
        users_roles r1_0 
            on u1_0.id=r1_0.user_id 
    left join
        roles r1_1 
            on r1_1.id=r1_0.role_id
2025-02-06 20:46:27.542 [http-nio-8081-exec-6] DEBUG org.hibernate.SQL - 
    /* <criteria> */ select
        r1_0.id,
        r1_0.name 
    from
        roles r1_0
2025-02-06 20:46:27.545 [http-nio-8081-exec-6] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:27.555 [http-nio-8081-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:33.575 [http-nio-8081-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing POST /logout
2025-02-06 20:46:33.577 [http-nio-8081-exec-7] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:33.577 [http-nio-8081-exec-7] DEBUG o.s.s.w.a.logout.LogoutFilter - Logging out [UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@7261e5f2, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ADMIN]]]
2025-02-06 20:46:33.577 [http-nio-8081-exec-7] DEBUG o.s.s.w.a.l.SecurityContextLogoutHandler - Invalidated session C4124B1F31875C46C1B754BE927AA49C
2025-02-06 20:46:33.577 [http-nio-8081-exec-7] DEBUG o.s.s.web.DefaultRedirectStrategy - Redirecting to /login?logout=true
2025-02-06 20:46:33.586 [http-nio-8081-exec-8] DEBUG o.s.security.web.FilterChainProxy - Securing GET /login?logout=true
2025-02-06 20:46:33.587 [http-nio-8081-exec-8] DEBUG o.s.security.web.FilterChainProxy - Secured GET /login?logout=true
2025-02-06 20:46:33.587 [http-nio-8081-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/login?logout=true", parameters={masked}
2025-02-06 20:46:33.588 [http-nio-8081-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ParameterizableViewController [view="login"]
2025-02-06 20:46:33.588 [http-nio-8081-exec-8] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:33.592 [http-nio-8081-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:33.592 [http-nio-8081-exec-8] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-02-06 20:46:36.156 [http-nio-8081-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing POST /login
2025-02-06 20:46:36.157 [http-nio-8081-exec-9] DEBUG org.hibernate.SQL - 
    /* SELECT
        u 
    FROM
        User u 
    JOIN
        
    FETCH
        u.roles 
    WHERE
        u.username = :username */ select
            u1_0.id,
            u1_0.age,
            u1_0.email,
            u1_0.first_name,
            u1_0.last_name,
            u1_0.password,
            r1_0.user_id,
            r1_1.id,
            r1_1.name,
            u1_0.username 
        from
            users u1_0 
        join
            users_roles r1_0 
                on u1_0.id=r1_0.user_id 
        join
            roles r1_1 
                on r1_1.id=r1_0.role_id 
        where
            u1_0.username=?
2025-02-06 20:46:36.302 [http-nio-8081-exec-9] DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-02-06 20:46:36.302 [http-nio-8081-exec-9] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Stored SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@41c9cfd5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER]]] to HttpSession [org.apache.catalina.session.StandardSessionFacade@5825b1a0]
2025-02-06 20:46:36.302 [http-nio-8081-exec-9] DEBUG o.s.s.w.a.UsernamePasswordAuthenticationFilter - Set SecurityContextHolder to UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@41c9cfd5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER]]
2025-02-06 20:46:36.302 [http-nio-8081-exec-9] INFO  r.k.s.b.d.configs.SuccessUserHandler - User 'user' successfully authenticated with roles: [ROLE_USER]
2025-02-06 20:46:36.310 [http-nio-8081-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing GET /user
2025-02-06 20:46:36.310 [http-nio-8081-exec-10] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@41c9cfd5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:46:36.310 [http-nio-8081-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured GET /user
2025-02-06 20:46:36.310 [http-nio-8081-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/user", parameters={}
2025-02-06 20:46:36.311 [http-nio-8081-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to ru.kata.spring.boot_security.demo.controllers.UserController#userPage(CustomUserDetails, Model)
2025-02-06 20:46:36.311 [http-nio-8081-exec-10] INFO  r.k.s.b.d.controllers.UserController - Authenticated user: user
2025-02-06 20:46:36.311 [http-nio-8081-exec-10] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:36.319 [http-nio-8081-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:40.107 [http-nio-8081-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing GET /logout
2025-02-06 20:46:40.108 [http-nio-8081-exec-1] DEBUG o.s.s.w.c.HttpSessionSecurityContextRepository - Retrieved SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@41c9cfd5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:46:40.108 [http-nio-8081-exec-1] DEBUG o.s.s.w.a.logout.LogoutFilter - Logging out [UsernamePasswordAuthenticationToken [Principal=ru.kata.spring.boot_security.demo.security.CustomUserDetails@41c9cfd5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_USER]]]
2025-02-06 20:46:40.108 [http-nio-8081-exec-1] DEBUG o.s.s.w.a.l.SecurityContextLogoutHandler - Invalidated session 0F8B69E670E66C0F35E979E96C5A745A
2025-02-06 20:46:40.108 [http-nio-8081-exec-1] DEBUG o.s.s.web.DefaultRedirectStrategy - Redirecting to /login?logout=true
2025-02-06 20:46:40.112 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing GET /login?logout=true
2025-02-06 20:46:40.112 [http-nio-8081-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured GET /login?logout=true
2025-02-06 20:46:40.113 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/login?logout=true", parameters={masked}
2025-02-06 20:46:40.113 [http-nio-8081-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ParameterizableViewController [view="login"]
2025-02-06 20:46:40.115 [http-nio-8081-exec-2] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-02-06 20:46:40.119 [http-nio-8081-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-02-06 20:46:40.119 [http-nio-8081-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-02-06 20:46:47.840 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-02-06 20:46:47.844 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-02-06 20:46:47.849 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-02-06 20:46:47.852 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-02-06 20:46:47.861 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
